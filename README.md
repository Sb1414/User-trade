# User-trade

## Описание базы данных

- Таблица «User» - таблица со списком пользователей
    - Id – идентификатор записи (GUID)
    - UserDomainName – идентификатор пользователя в формате «Lanit\ivan.ivanov»
    - Таблица должна содержать содержать соответствующие записи (не менее 10)
- Таблица «Data» - данные содержит данные для пользователя. Таблица связна с таблицей «User» связью N:1
    - Id – идентификатор записи (GUID)
    - UserId – идентификатор пользователя
    - Entity – строковый, внутри в формате JSON содержится сериализованное представление объекта «Сделка»

## Спецификация объекта «Сделка»
```
class Trade
{
    public decimal Amount;
    public DateTime CreatedAt;
}
```
    
## REST WEB-сервис

- Сервис реализован как отдельный проект на базе ***ASP.NET MVC WebAPI*** и имеет ***REST-архитектуру***
- Сервис работает на компьютере разработчика
- У сервиса настроена аутентификация
- Сервис реализовывает:
    - Метод, возвращающий сумму последней сделки для вызывающего сервис клиента.
    - Метод автоматически определяет учетную запись того, кто его вызывает и создает строковый идентификатор пользователя в формате *«Domain\User»*. То есть в таком же формате, в какой он лежит в БД в таблице пользователей.
    - Метод обращается к БД, находит в таблице пользователей пользователя по этому идентификатору
    - Метод находит все объекты пользователя из таблицы *Data*, десериализует поле *Entity* в объект *«Сделка»*
    - Сравнивает все полученные для пользователя объекты и находит среди них самую последнюю сделку (у объекта сделка есть поле «Дата сделки»)
    - Возвращает клиенту дату и сумму сделки как отдельный класс. В качестве транспортного формата используется JSON.
- Строку подключения к БД сервис берет из конфигурационного файла

## Консольное приложение
Приложение осуществлять обращение к сервису и вызов метода.
- Приложение выводит на консоль дату и сумму последней сделки текущего вызывающего пользователя
- Дата сделки должна выводится с учетом часового пояса, в котором находится вызывающий
- После вывода суммы приложение завершается

## Web-приложение на MVC
- Приложение умеет вызывать метод упомянутого WEB-сервиса двумя способами:
    - Через JS
    - Из C# кода
- Каждому способу соответствовует отдельная страница
- Приложение должно иметь корневую страницу со ссылками на страницы вызова